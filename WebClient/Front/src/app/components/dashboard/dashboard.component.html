<div class="container-fluid">
  <!-- Page Header -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center">
        <div>
          <h2 class="h3 mb-1">Dashboard</h2>
          <p class="text-muted mb-0">Privire generală asupra activității platformei</p>
        </div>
        <div>
          <button class="btn btn-primary-modern btn-modern" (click)="refreshData()" [disabled]="loading">
            <i class="bi bi-arrow-clockwise me-2"></i>
            {{ loading ? 'Se actualizează...' : 'Actualizează' }}
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Statistics Cards -->
  <div class="row mb-5">
    <div class="col-xl-3 col-lg-6 col-md-6 mb-4">
      <div class="dashboard-card position-relative">
        <i class="bi bi-box-seam dashboard-card-icon text-primary"></i>
        <div>
          <h3 class="dashboard-card-value text-primary">{{ stats.totalProducts }}</h3>
          <p class="dashboard-card-label">Total Produse</p>
        </div>
        <div class="d-flex align-items-center" *ngIf="stats.totalProducts === 0">
          <small class="text-muted"><i class="bi bi-info-circle"></i> Începe prin a încărca primul feed</small>
        </div>
      </div>
    </div>

    <div class="col-xl-3 col-lg-6 col-md-6 mb-4">
      <div class="dashboard-card position-relative">
        <i class="bi bi-check-circle dashboard-card-icon text-success"></i>
        <div>
          <h3 class="dashboard-card-value text-success">{{ stats.successfulExports }}</h3>
          <p class="dashboard-card-label">Exporturi Reușite</p>
        </div>
        <div class="d-flex align-items-center" *ngIf="stats.successfulExports === 0">
          <small class="text-muted"><i class="bi bi-info-circle"></i> Niciun export efectuat încă</small>
        </div>
      </div>
    </div>

    <div class="col-xl-3 col-lg-6 col-md-6 mb-4">
      <div class="dashboard-card position-relative">
        <i class="bi bi-exclamation-triangle dashboard-card-icon text-warning"></i>
        <div>
          <h3 class="dashboard-card-value text-warning">{{ stats.failedExports }}</h3>
          <p class="dashboard-card-label">Exporturi Eșuate</p>
        </div>
        <div class="d-flex align-items-center" *ngIf="stats.failedExports === 0">
          <small class="text-muted"><i class="bi bi-shield-check"></i> Sistem gata de utilizare</small>
        </div>
      </div>
    </div>

    <div class="col-xl-3 col-lg-6 col-md-6 mb-4">
      <div class="dashboard-card position-relative">
        <i class="bi bi-clock dashboard-card-icon text-info"></i>
        <div>
          <h3 class="dashboard-card-value text-info">
            {{ stats.lastExport ? (stats.lastExport | date:'dd/MM HH:mm') : 'N/A' }}
          </h3>
          <p class="dashboard-card-label">Ultimul Export</p>
        </div>
        <div class="d-flex align-items-center">
          <small class="text-muted">
            <i class="bi bi-calendar"></i> {{ getTimeAgo(stats.lastExport) }}
          </small>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content Row -->
  <div class="row">
    <!-- Recent Activity -->
    <div class="col-lg-8 mb-4">
      <div class="modern-card">
        <div class="card-header-modern">
          <h5 class="card-title-modern">
            <i class="bi bi-activity me-2"></i>
            Activitate Recentă
          </h5>
        </div>
        <div class="card-body-modern">
          <div *ngIf="recentActivities.length > 0; else noActivities" class="table-responsive">
            <table class="table table-modern">
              <thead>
                <tr>
                  <th>Tip</th>
                  <th>Descriere</th>
                  <th>Status</th>
                  <th>Data</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let activity of recentActivities">
                  <td>
                    <i [class]="getActivityIcon(activity.type)" [class.text-primary]="activity.type === 'upload'" 
                       [class.text-success]="activity.type === 'export'" [class.text-warning]="activity.type === 'mapping'"></i>
                    {{ getActivityTypeLabel(activity.type) }}
                  </td>
                  <td>{{ activity.description }}</td>
                  <td>
                    <span [class]="getStatusClass(activity.status)">
                      {{ activity.status }}
                    </span>
                  </td>
                  <td>{{ activity.date | date:'dd/MM/yyyy HH:mm' }}</td>
                </tr>
              </tbody>
            </table>
          </div>
          
          <ng-template #noActivities>
            <div class="text-center py-5">
              <i class="bi bi-activity display-1 text-muted"></i>
              <h5 class="text-muted mt-3">Nu există activitate recentă</h5>
              <p class="text-muted">Activitățile tale vor apărea aici după primul upload sau export.</p>
            </div>
          </ng-template>
        </div>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="col-lg-4 mb-4">
      <div class="modern-card">
        <div class="card-header-modern">
          <h5 class="card-title-modern">
            <i class="bi bi-lightning me-2"></i>
            Acțiuni Rapide
          </h5>
        </div>
        <div class="card-body-modern">
          <div class="d-grid gap-3">
            <button class="btn btn-primary-modern btn-modern d-flex align-items-center" 
                    routerLink="/feed-management">
              <i class="bi bi-upload me-2"></i>
              <div class="text-start">
                <div class="fw-bold">Încarcă Feed</div>
                <small class="opacity-75">CSV, Excel, XML, JSON</small>
              </div>
            </button>
            
            <button class="btn btn-outline-primary btn-modern d-flex align-items-center" 
                    routerLink="/category-mapping">
              <i class="bi bi-diagram-3 me-2"></i>
              <div class="text-start">
                <div class="fw-bold">Mapare Categorii</div>
                <small class="opacity-75">Asociază categoriile</small>
              </div>
            </button>
            
            <button class="btn btn-outline-primary btn-modern d-flex align-items-center" 
                    routerLink="/product-export">
              <i class="bi bi-download me-2"></i>
              <div class="text-start">
                <div class="fw-bold">Export Produse</div>
                <small class="opacity-75">Generează fișier Excel</small>
              </div>
            </button>
            
            <button class="btn btn-outline-secondary btn-modern d-flex align-items-center" 
                    routerLink="/admin-panel">
              <i class="bi bi-gear me-2"></i>
              <div class="text-start">
                <div class="fw-bold">Configurări</div>
                <small class="opacity-75">API tokens, utilizatori</small>
              </div>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Scheduled Exports -->
  <div class="row">
    <div class="col-12">
      <div class="modern-card">
        <div class="card-header-modern">
          <div class="d-flex justify-content-between align-items-center">
            <h5 class="card-title-modern">
              <i class="bi bi-calendar-event me-2"></i>
              Exporturi Programate
            </h5>
            <button class="btn btn-outline-primary btn-sm" (click)="openScheduleModal()">
              <i class="bi bi-plus-circle me-1"></i>
              Adaugă Export Programat
            </button>
          </div>
        </div>
        <div class="card-body-modern">
          <div class="row" *ngIf="scheduledExports.length > 0">
            <div class="col-md-4 mb-3" *ngFor="let schedule of scheduledExports">
              <div class="border rounded-3 p-3 h-100">
                <div class="d-flex justify-content-between align-items-start mb-2">
                  <div>
                    <h6 class="mb-1">{{ schedule.name }}</h6>
                    <small class="text-muted">{{ schedule.marketplace }}</small>
                  </div>
                  <span class="badge" [class.bg-success]="schedule.active" [class.bg-secondary]="!schedule.active">
                    {{ schedule.active ? 'Activ' : 'Inactiv' }}
                  </span>
                </div>
                <div class="mb-2">
                  <small class="text-muted d-block">
                    <i class="bi bi-clock me-1"></i>
                    {{ schedule.schedule }}
                  </small>
                  <small class="text-muted d-block">
                    <i class="bi bi-calendar me-1"></i>
                    Următorul export: {{ schedule.nextRun | date:'dd/MM/yyyy HH:mm' }}
                  </small>
                </div>
                <div class="d-flex gap-2">
                  <button class="btn btn-sm btn-outline-primary">
                    <i class="bi bi-pencil"></i>
                  </button>
                  <button class="btn btn-sm" [class.btn-outline-danger]="schedule.active" [class.btn-outline-success]="!schedule.active">
                    <i [class.bi-pause]="schedule.active" [class.bi-play]="!schedule.active"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
          
          <div *ngIf="scheduledExports.length === 0" class="text-center py-5">
            <i class="bi bi-calendar-x display-1 text-muted"></i>
            <h5 class="text-muted mt-3">Nu există exporturi programate</h5>
            <p class="text-muted">Creează primul tău export automat pentru a economisi timp.</p>
            <button class="btn btn-primary-modern btn-modern" (click)="openScheduleModal()">
              <i class="bi bi-plus-circle me-2"></i>
              Creează Export Programat
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div> 